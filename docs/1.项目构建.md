<!--
 * @Author: raotaohub
 * @Date: 2021-02-20 00:08:15
 * @LastEditTime: 2021-02-20 14:42:02
 * @LastEditors: raotaohub
 * @FilePath: \react_admin_client_ts\docs\1.项目构建.md
 * @Description: Edit......
-->

# 项目构建阶段

前言：开发一套后台项目做技术储备，冒进尝试不熟悉的 Ts+React 进行开发。步子越大，扯蛋= =。。

## 1.初始化项目

`create-react-app react_admin_client_ts --typescript`

`yarn add antd --save`

```
 "babel-plugin-import": "^1.11.0",
  "antd": "^4.12.3",
  "babel-plugin-import": "^1.11.0",
  "less": "^3.12.2",
  "less-loader": "^5.0.0",
  "react-app-rewired": "^2.1.8",
  "react-router-config": "^5.1.1",
  "react-router-dom": "^5.1.2",
  "redux": "^4.0.1",
  "redux-thunk": "^2.3.0",
```

## 2.创建目录

```

src/
+ api
+ assets
+ components
+ page
+ routes
+ store
+ style
+ utils

```

## 3.antd 自定义主题和按需加载

根目录新建文件夹 `.cz-config.js`

配置

```js
module.exports = {
  types: [
    {
      value: "feat",
      name: "feat:     A new feature",
    },
    {
      value: "fix",
      name: "fix:      A bug fix",
    },
    {
      value: "docs",
      name: "docs:     Documentation only changes",
    },
    {
      value: "refactor",
      name:
        "refactor: A code change that neither fixes a bug nor adds a feature",
    },
    {
      value: "perf",
      name: "perf:     A code change that improves performance",
    },
    {
      value: "test",
      name: "test:     Add missing tests or correcting existing tests",
    },
    {
      value: "build",
      name: "build:    Add missing tests or correcting existing tests",
    },
    {
      value: "revert",
      name: "revert:   Revert to a commit",
    },
  ],
  allowBreakingChanges: ["feat", "fix", "refactor", "perf", "build", "revert"],
};
```

## 4.配置路由

```js
// src/routes/index.js

import { Redirect } from "react-router-dom";

import Admin from "../page/admin/admin";
import Login from "../page/login/login";

const routes = [
  {
    path: "/",
    exact: true,
    render: () => <Redirect to={"/login"} />,
  },
  {
    path: "/login",
    component: Login,
  },
  {
    path: "/admin",
    component: Admin,
  },
];

export default routes;
```

## 5.创建路由对应的路由页面

```
新建文件
+ src/page/login/login.jsx
+ src/page/admin/admin.jsx

//admin.jsx
import React, { ReactElement } from "react";

function Admin(): ReactElement {
  return (
    <div className="admin">
      <h1>管理模块！！！！！！！！！！！！！！！！！！！！</h1>
    </div>
  );
}

export default Admin;

//login.jsx
...同上
```

## 6.配置 redux

```
新建文件
+ src/store
  + index.js
  + reducers.js

```

进入 index.js 配置 store 对象

```js
// 引入创建store对象方法，支持异步的中间件和避免嵌套穿参的compose函数，
import { createStore, applyMiddleware, compose } from "redux";
import thunk from "redux-thunk";
// 引入reducers，包含所有的reducer
import reducers from "./reducers";

const store = createStore(reducers, compose(applyMiddleware(thunk)));

export default store;
```

进入 reducers 将全部的 reducer 集中到这里并导出给 store

```js
import { combineReducers } from "redux";
// 未来在这里引入不同的reducer xx1,xx2 等等
export default combineReducers({
  xx1,
  xx2,
  // ....
});
```

## 7.在 App 组件注入路由和 store；注入灵魂;注入路由

src/App.jsx

```js
import React from "react";
import { Provider } from "react-redux";
import rotes from "./routes/index.js";
import store from "./store/index.js";
import { BrowserRouter } from "react-router-dom";
import { renderRoutes } from "react-routes-config";

function App() {
  return (
    <Provider store={store}>
      <BrowserRouter>{renderRoutes(routes)}</BrowserRouter>
    </Provider>
  );
}
```

## 8.初始化 css github 上的 reset 即可

```js
+reset.css;

src / index.jsx;

import "./style/reset.css";
```
